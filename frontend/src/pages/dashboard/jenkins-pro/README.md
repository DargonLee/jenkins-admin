# Jenkins Pro - 企业级CI/CD管理平台

Jenkins Pro 是一个现代化的Jenkins管理界面，提供了更好的用户体验和功能组织。

## 功能特性

### 🎯 概览仪表板
- **系统统计**: 显示总任务数、活跃构建、成功率、平均构建时间等关键指标
- **最近活动**: 实时显示最新的构建活动和系统事件
- **快捷操作**: 提供常用操作的快速入口
- **构建趋势**: 显示过去7天的构建统计和趋势分析

### 📋 任务管理
- **任务列表**: 以卡片形式展示所有Jenkins任务
- **搜索过滤**: 支持按任务名称搜索和状态筛选
- **任务状态**: 直观显示任务的运行状态（成功、失败、运行中、不稳定）
- **快速操作**: 直接从任务卡片触发构建或查看详情

### 🔄 构建监控
- **构建队列**: 显示当前排队和正在执行的构建任务
- **实时监控**: 实时显示正在运行的构建进度
- **构建历史**: 查看最近完成的构建历史记录
- **状态跟踪**: 详细的构建状态和时间信息

### ⚙️ 系统信息
- **服务器状态**: Jenkins版本、运行时间、执行器状态等
- **系统资源**: CPU、内存、磁盘使用率监控
- **iOS发布配置**: TestFlight和App Store发布设置管理
- **系统日志**: 最近的系统事件和日志记录

### 📱 iOS发布功能
- **智能识别**: 自动识别iOS项目（基于项目名称关键词）
- **TestFlight发布**: 构建成功后一键发布到TestFlight
- **App Store发布**: 构建成功后一键提交到App Store审核
- **发布配置**: 统一管理API密钥、证书、团队ID等配置
- **发布历史**: 在构建历史中显示发布状态和操作

### 🔄 Pipeline可视化
- **流程图展示**: 直观显示Pipeline各个阶段的执行流程
- **实时状态**: 实时更新每个阶段的执行状态和进度
- **阶段详情**: 查看每个阶段的执行时间、日志和错误信息
- **交互式界面**: 点击阶段查看详细信息和日志
- **进度跟踪**: 显示整体进度和预估完成时间

### 🚨 告警和通知
- **多种告警类型**: 构建失败、构建超时、资源告警、成功率告警
- **企业微信集成**: 支持企业微信机器人推送告警消息
- **告警中心**: 统一管理所有告警记录和状态
- **智能配置**: 可配置告警阈值和通知规则
- **告警确认**: 支持告警确认和状态管理

## 技术架构

### 组件结构
```
jenkins-pro/
├── index.tsx                    # 主页面组件
├── hooks/
│   └── use-jenkins-pro.ts      # 业务逻辑Hook
├── components/
│   ├── dashboard-widgets.tsx    # 仪表板组件
│   ├── build-monitor.tsx       # 构建监控组件
│   ├── pipeline-visualization.tsx  # Pipeline可视化组件
│   └── alert-notification.tsx  # 告警通知组件
└── README.md                   # 文档说明
```

### 核心Hook: useJenkinsPro

提供了完整的状态管理和业务逻辑：

```typescript
const {
  // 状态
  systemStats,
  filteredJobs,
  buildQueue,
  buildHistory,
  loading,
  error,
  
  // 操作函数
  triggerBuild,
  refreshAll,
  
  // 搜索和过滤
  searchQuery,
  statusFilter,
  setSearchQuery,
  setStatusFilter
} = useJenkinsPro();
```

### 主要组件

#### 1. StatsCard - 统计卡片
显示关键指标，支持变化趋势显示

#### 2. JobCard - 任务卡片
展示任务信息，支持快速操作

#### 3. BuildQueue - 构建队列
显示排队和运行中的构建任务

#### 4. BuildHistory - 构建历史
展示历史构建记录

#### 5. RecentActivity - 最近活动
显示系统最新活动

## 设计特点

### 🎨 现代化UI设计
- 采用卡片式布局，信息层次清晰
- 渐变背景和阴影效果，提升视觉体验
- 响应式设计，适配不同屏幕尺寸
- 统一的颜色系统和图标使用

### 🚀 用户体验优化
- 加载状态指示，避免用户等待焦虑
- 错误处理和提示，友好的错误信息
- 实时数据更新，保持信息同步
- 快捷操作，减少操作步骤

### 📱 响应式设计
- 移动端友好的布局
- 自适应的网格系统
- 触摸友好的交互元素

## 使用方法

### 1. 概览仪表板
- 查看系统整体状态和关键指标
- 通过最近活动了解系统动态
- 使用快捷操作快速执行常用任务

### 2. 任务管理
- 使用搜索框快速找到特定任务
- 通过状态筛选查看不同状态的任务
- 点击任务卡片查看详情或触发构建

### 3. 构建监控
- 实时查看构建队列状态
- 监控正在运行的构建进度
- 浏览构建历史记录

### 4. 系统信息
- 查看Jenkins服务器状态
- 监控系统资源使用情况
- 配置iOS发布设置（TestFlight/App Store）
- 查看系统日志和事件

### 4. Pipeline可视化
- **选择Pipeline**: 输入任务名称和构建号查看Pipeline流程
- **流程图查看**: 直观的水平流程图显示各个阶段
- **阶段详情**: 点击阶段查看详细执行信息和日志
- **实时更新**: 运行中的Pipeline会实时更新状态和进度

### 5. 告警中心
- **查看告警**: 查看所有告警记录和未读告警数量
- **确认告警**: 点击确认按钮标记告警为已读
- **配置告警**: 设置告警类型、阈值和企业微信Webhook
- **企业微信通知**: 配置企业微信机器人接收告警推送

### 6. iOS发布功能
- **自动识别iOS项目**: 系统会自动识别包含iOS相关关键词的项目
- **构建后发布**: 构建成功后，iOS项目会显示发布按钮
- **TestFlight发布**: 点击蓝色TestFlight按钮发布测试版本
- **App Store发布**: 点击紫色App Store按钮提交正式版本
- **发布配置管理**: 在系统信息页面管理发布相关配置

## 扩展性

### 添加新功能
1. 在 `hooks/use-jenkins-pro.ts` 中添加新的状态和操作函数
2. 在 `components/` 目录下创建新的组件
3. 在主页面中集成新组件

### 自定义样式
- 使用 Tailwind CSS 类进行样式定制
- 通过 shadcn/ui 组件系统保持一致性
- 支持深色/浅色主题切换

## 性能优化

- 使用 React.memo 优化组件渲染
- 实现虚拟滚动处理大量数据
- 合理的数据缓存和更新策略
- 懒加载非关键组件

## 企业微信告警配置

### 1. 创建企业微信机器人
1. 在企业微信群中，点击群设置 → 群机器人 → 添加机器人
2. 选择"自定义机器人"，设置机器人名称和头像
3. 复制生成的Webhook地址，格式如：
   ```
   https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
   ```

### 2. 配置告警
1. 进入Jenkins Pro → 告警中心 → 告警配置
2. 启用告警功能
3. 粘贴企业微信Webhook URL
4. 配置需要的告警类型和阈值
5. 保存配置

### 3. 告警消息格式
告警消息会以Markdown格式发送到企业微信群：
```markdown
## 🚨 Jenkins 告警通知

**告警类型**: build_failure
**严重程度**: high
**告警标题**: 构建失败告警

**详细信息**:
任务 "frontend-build" 的构建 #145 执行失败，请检查构建日志并及时处理。

**任务名称**: frontend-build
**构建号**: #145

**时间**: 2024-01-15 14:30:25

---
> 请及时处理相关问题
```

## 未来规划

- [x] Pipeline可视化功能
- [x] 企业微信告警通知
- [ ] 集成图表库显示详细趋势
- [ ] 添加构建日志实时查看
- [ ] 支持批量操作
- [ ] 支持自定义仪表板布局
- [ ] 集成更多Jenkins插件功能
- [ ] 添加邮件告警支持
- [ ] 支持钉钉、飞书等其他通知渠道

## 依赖项

- React 18+
- TypeScript
- Tailwind CSS
- shadcn/ui 组件库
- Lucide React 图标库
- Sonner 通知库

## 贡献指南

1. 遵循现有的代码风格和组件结构
2. 添加适当的TypeScript类型定义
3. 确保响应式设计兼容性
4. 添加必要的错误处理
5. 更新相关文档
